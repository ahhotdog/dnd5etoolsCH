"use strict";const MONTH_NAMES=["January","February","March","April","May","June","July","August","September","October","November","December"],CONTENTS_URL="data/adventures.json";let list;function onJsonLoad(t){list=new List("listcontainer",{valueNames:["name","source"],listClass:"books"}),$("#filtertools").find("button.sort").on(EVNT_CLICK,function(){const t=$(this);"asc"===t.attr("sortby")?t.attr("sortby","desc"):t.attr("sortby","asc"),list.sort(t.data("sort"),{order:t.attr("sortby"),sortFunction:sortAdventures})}),list.sort("name"),$("#reset").click(function(){$("#search").val(""),list.search(),list.sort("name"),list.filter(),$(".showhide").each((t,e)=>{$(e).data("hidden")||BookUtil.indexListToggle(null,e)})}),handleBrew(t),BrewUtil.pAddBrewData().then(addAdventures).catch(BrewUtil.purgeBrew).then(()=>BrewUtil.makeBrewButton("manage-brew"))}function handleBrew(t){addAdventures(t)}window.onload=function(){DataUtil.loadJSON(CONTENTS_URL).then(onJsonLoad)};let adventureList=[],adI=0;function addAdventures(t){if(!t.adventure||!t.adventure.length)return;adventureList=adventureList.concat(t.adventure);const e=$("ul.books");let n="";for(;adI<adventureList.length;adI++){const t=adventureList[adI];t._startLevel=t.level.start||20,t._pubDate=new Date(t.published),n+=`<li ${FLTR_ID}="${adI}">\n\t\t\t\t<a href="adventure.html#${t.id}" title="${t.name}" class="adv-name">\n\t\t\t\t\t<span class='name'>\n\t\t\t\t\t\t<span class="col-xs-6 col-xs-6-2">${t.name}</span>\n\t\t\t\t\t\t<span class="col-xs-2 col-xs-2-5 adv-detail">${t.storyline}</span>\n\t\t\t\t\t\t<span class="col-xs-1 col-xs-1-3 adv-detail">${s(t)}</span>\n\t\t\t\t\t\t<span class="col-xs-2 adv-detail">${r(t)}</span>\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class="showhide" onclick="BookUtil.indexListToggle(event, this)" data-hidden="true">[+]</span>\n\t\t\t\t\t<span class="source" style="display: none">${t.id}</span>\n\t\t\t\t</a>\n\t\t\t\t${BookUtil.makeContentsBlock({book:t,addPrefix:"adventure.html",defaultHidden:!0})}\n\t\t\t</li>`}const a=ListUtil.getSearchTermAndReset(list);function s(t){return t.level.custom?t.level.custom:`Level ${t.level.start}â€“${t.level.end}`}function r(t){const e=new Date(t.published);return`${MONTH_NAMES[e.getMonth()]} ${e.getDate()}, ${e.getFullYear()}`}e.append(n),list.reIndex(),a&&list.search(a),list.sort("name")}function sortAdventures(t,e,n){if(t=adventureList[t.elm.getAttribute(FLTR_ID)],e=adventureList[e.elm.getAttribute(FLTR_ID)],"name"===n.valueName)return a();if("storyline"===n.valueName)return s(SortUtil.ascSort,"storyline");if("level"===n.valueName)return s(SortUtil.ascSort,"_startLevel");if("published"===n.valueName)return s(function(t,e){return e.getTime()-t.getTime()},"_pubDate");function a(){return SortUtil.ascSort(t.name,e.name)}function s(n,s){const r=n(t[s],e[s]);return 0!==r?r:a()}}